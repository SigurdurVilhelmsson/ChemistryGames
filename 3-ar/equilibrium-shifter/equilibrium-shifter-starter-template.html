<!DOCTYPE html>
<html lang="is">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Equilibrium Shifter - Kvenno Efnafr√¶√∞i</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Kvenno Brand Colors */
        :root {
            --kvenno-orange: #f36b22;
            --kvenno-orange-dark: #d95a1a;
        }

        body {
            margin: 0;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen',
                'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue',
                sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            background: #f9fafb;
        }

        /* Header Styles */
        .site-header {
            background: white;
            border-bottom: 2px solid #e5e7eb;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
        }

        .header-content {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 1rem;
            height: 60px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .site-logo {
            font-size: 1.25rem;
            font-weight: bold;
            color: var(--kvenno-orange);
            text-decoration: none;
        }

        .site-logo:hover {
            color: var(--kvenno-orange-dark);
        }

        .header-btn {
            background: white;
            border: 2px solid var(--kvenno-orange);
            color: var(--kvenno-orange);
            padding: 8px 16px;
            border-radius: 8px;
            font-size: 0.875rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-left: 0.5rem;
        }

        .header-btn:hover {
            background: var(--kvenno-orange);
            color: white;
        }

        /* Back Button */
        .back-btn {
            background: white;
            border: 2px solid var(--kvenno-orange);
            color: var(--kvenno-orange);
            padding: 8px 16px;
            border-radius: 8px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            text-decoration: none;
            font-size: 0.875rem;
            margin: 0 1rem 1rem 1rem;
        }

        .back-btn:hover {
            background: var(--kvenno-orange);
            color: white;
        }

        /* Equilibrium Arrow Styles */
        .equilibrium-arrows {
            font-size: 3rem;
            transition: all 0.5s ease;
        }

        .equilibrium-arrows.shift-right {
            color: #22c55e;
            transform: scale(1.2);
        }

        .equilibrium-arrows.shift-left {
            color: #22c55e;
            transform: scale(1.2) scaleX(-1);
        }

        .equilibrium-arrows.no-shift {
            color: #eab308;
            animation: shake 0.5s ease;
        }

        /* Molecule Container */
        .molecule-container {
            display: flex;
            gap: 8px;
            align-items: center;
            justify-content: center;
            min-height: 100px;
            padding: 20px;
            border-radius: 12px;
            transition: all 0.5s ease;
        }

        .molecule {
            font-size: 2rem;
            transition: all 0.3s ease;
            animation: float 2s ease-in-out infinite;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-5px); }
        }

        .reactants-side {
            background: linear-gradient(135deg, #dbeafe 0%, #bfdbfe 100%);
        }

        .products-side {
            background: linear-gradient(135deg, #fce7f3 0%, #fbcfe8 100%);
        }

        .reactants-side.glowing {
            background: linear-gradient(135deg, #86efac 0%, #4ade80 100%);
            box-shadow: 0 0 20px rgba(74, 222, 128, 0.5);
        }

        .products-side.glowing {
            background: linear-gradient(135deg, #86efac 0%, #4ade80 100%);
            box-shadow: 0 0 20px rgba(74, 222, 128, 0.5);
        }

        /* Thermodynamics Indicator */
        .thermo-indicator {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 8px 16px;
            border-radius: 20px;
            font-weight: 600;
        }

        .thermo-indicator.exothermic {
            background: linear-gradient(135deg, #fca5a5 0%, #f87171 100%);
            color: #7f1d1d;
        }

        .thermo-indicator.endothermic {
            background: linear-gradient(135deg, #93c5fd 0%, #60a5fa 100%);
            color: #1e3a8a;
        }

        /* Stress Buttons */
        .stress-btn {
            background: linear-gradient(135deg, #a78bfa 0%, #8b5cf6 100%);
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 12px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .stress-btn:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(139, 92, 246, 0.4);
        }

        .stress-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .stress-btn.selected {
            background: linear-gradient(135deg, #eab308 0%, #f59e0b 100%);
            box-shadow: 0 0 20px rgba(234, 179, 8, 0.5);
        }

        /* Prediction Buttons */
        .predict-btn {
            flex: 1;
            padding: 20px;
            border-radius: 16px;
            font-size: 1.25rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 3px solid transparent;
        }

        .predict-btn:hover:not(:disabled) {
            transform: scale(1.05);
        }

        .predict-btn.left {
            background: linear-gradient(135deg, #93c5fd 0%, #60a5fa 100%);
            color: #1e3a8a;
        }

        .predict-btn.none {
            background: linear-gradient(135deg, #fde68a 0%, #fbbf24 100%);
            color: #78350f;
        }

        .predict-btn.right {
            background: linear-gradient(135deg, #86efac 0%, #4ade80 100%);
            color: #14532d;
        }

        /* Animations */
        @keyframes pulse-success {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        .pulse-success {
            animation: pulse-success 0.6s ease-in-out;
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0) rotate(0deg); }
            25% { transform: translateX(-10px) rotate(-2deg); }
            75% { transform: translateX(10px) rotate(2deg); }
        }

        .shake {
            animation: shake 0.4s ease-in-out;
        }

        @keyframes slideInRight {
            from {
                opacity: 0;
                transform: translateX(-30px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        .slide-in-right {
            animation: slideInRight 0.5s ease-out;
        }

        /* Mobile Optimizations */
        @media (max-width: 768px) {
            .molecule {
                font-size: 1.5rem;
            }
            
            .equilibrium-arrows {
                font-size: 2rem;
            }
            
            .predict-btn {
                padding: 15px;
                font-size: 1rem;
            }
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // ============================================
        // CONFIGURATION & CONSTANTS
        // ============================================
        
        const TRANSLATIONS = {
            learningMode: "L√¶rd√≥mshamur",
            challengeMode: "Keppnishamur",
            equilibrium: "Jafnv√¶gi",
            stress: "√Ålag",
            predict: "Forsp√°",
            shiftLeft: "Hli√∞run til vinstri",
            shiftRight: "Hli√∞run til h√¶gri",
            noShift: "Engin hli√∞run",
            addReactant: "B√¶ta vi√∞ hvarfefni",
            addProduct: "B√¶ta vi√∞ afur√∞",
            removeReactant: "Fjarl√¶gja hvarfefni",
            removeProduct: "Fjarl√¶gja afur√∞",
            heat: "Hita",
            cool: "K√¶la",
            increasePressure: "Auka √ær√Ωsting",
            decreasePressure: "Minnka √ær√Ωsting",
            addCatalyst: "B√¶ta vi√∞ hvata",
            correct: "R√©tt!",
            incorrect: "Rangt",
            explanation: "√ötsk√Ωring",
            exothermic: "Varmalosandi",
            endothermic: "Varmabindandi",
            score: "Stig",
            streak: "Runa",
            time: "T√≠mi",
            back: "Til baka",
        };

        // Molecule display mappings
        const MOLECULE_DISPLAY = {
            'N‚ÇÇ': 'üîµüîµ',
            'H‚ÇÇ': '‚ö™‚ö™',
            'O‚ÇÇ': 'üî¥üî¥',
            'NH‚ÇÉ': 'üî∑',
            'NO‚ÇÇ': 'üü§',
            'N‚ÇÇO‚ÇÑ': '‚ö´',
            'SO‚ÇÇ': 'üíõ',
            'SO‚ÇÉ': 'üü°',
            'H‚ÇÇO': 'üíß',
            'CO': '‚ö´üî¥',
            'CO‚ÇÇ': '‚ö´üî¥üî¥',
        };

        // ============================================
        // LE CHATELIER LOGIC ENGINE
        // ============================================
        
        const calculateShift = (equilibrium, stressType, stressTarget) => {
            // This function implements Le Chatelier's Principle
            
            let shift = 'none';
            let explanation = '';
            
            switch(stressType) {
                case 'add-reactant':
                    shift = 'right';
                    explanation = `Adding ${stressTarget} (reactant) shifts equilibrium RIGHT toward products.`;
                    break;
                    
                case 'add-product':
                    shift = 'left';
                    explanation = `Adding ${stressTarget} (product) shifts equilibrium LEFT toward reactants.`;
                    break;
                    
                case 'remove-reactant':
                    shift = 'left';
                    explanation = `Removing ${stressTarget} (reactant) shifts equilibrium LEFT to replace it.`;
                    break;
                    
                case 'remove-product':
                    shift = 'right';
                    explanation = `Removing ${stressTarget} (product) shifts equilibrium RIGHT to replace it.`;
                    break;
                    
                case 'increase-temp':
                    if (equilibrium.deltaH > 0) {
                        // Endothermic: heat is reactant
                        shift = 'right';
                        explanation = 'Endothermic: Adding heat shifts RIGHT (heat is reactant).';
                    } else {
                        // Exothermic: heat is product
                        shift = 'left';
                        explanation = 'Exothermic: Adding heat shifts LEFT (heat is product).';
                    }
                    break;
                    
                case 'decrease-temp':
                    if (equilibrium.deltaH > 0) {
                        // Endothermic
                        shift = 'left';
                        explanation = 'Endothermic: Removing heat shifts LEFT (toward heat).';
                    } else {
                        // Exothermic
                        shift = 'right';
                        explanation = 'Exothermic: Removing heat shifts RIGHT (toward heat).';
                    }
                    break;
                    
                case 'increase-pressure':
                    const reactantMoles = equilibrium.totalGasMoles.reactants;
                    const productMoles = equilibrium.totalGasMoles.products;
                    
                    if (reactantMoles > productMoles) {
                        shift = 'right';
                        explanation = `Increasing pressure shifts toward fewer moles: RIGHT (${productMoles} moles).`;
                    } else if (reactantMoles < productMoles) {
                        shift = 'left';
                        explanation = `Increasing pressure shifts toward fewer moles: LEFT (${reactantMoles} moles).`;
                    } else {
                        shift = 'none';
                        explanation = 'Equal gas moles on both sides: NO SHIFT from pressure change.';
                    }
                    break;
                    
                case 'decrease-pressure':
                    const rMoles = equilibrium.totalGasMoles.reactants;
                    const pMoles = equilibrium.totalGasMoles.products;
                    
                    if (rMoles < pMoles) {
                        shift = 'right';
                        explanation = `Decreasing pressure shifts toward more moles: RIGHT (${pMoles} moles).`;
                    } else if (rMoles > pMoles) {
                        shift = 'left';
                        explanation = `Decreasing pressure shifts toward more moles: LEFT (${rMoles} moles).`;
                    } else {
                        shift = 'none';
                        explanation = 'Equal gas moles on both sides: NO SHIFT from pressure change.';
                    }
                    break;
                    
                case 'add-catalyst':
                    shift = 'none';
                    explanation = 'Catalyst speeds BOTH directions equally: NO SHIFT. K unchanged.';
                    break;
            }
            
            return { shift, explanation };
        };

        // ============================================
        // EQUILIBRIUM DATA GENERATOR
        // ============================================
        
        const generateEquilibria = () => {
            // TODO: Create 30+ equilibrium systems
            
            const exampleEquilibrium = {
                id: 1,
                equation: 'N‚ÇÇ(g) + 3H‚ÇÇ(g) ‚áå 2NH‚ÇÉ(g)',
                name: 'Haber Process',
                nameIs: 'Haber-a√∞fer√∞',
                difficulty: 'intermediate',
                
                reactants: [
                    { formula: 'N‚ÇÇ', coefficient: 1, phase: 'g', display: 'üîµüîµ' },
                    { formula: 'H‚ÇÇ', coefficient: 3, phase: 'g', display: '‚ö™‚ö™' }
                ],
                
                products: [
                    { formula: 'NH‚ÇÉ', coefficient: 2, phase: 'g', display: 'üî∑' }
                ],
                
                deltaH: -92, // kJ/mol (negative = exothermic)
                
                totalGasMoles: {
                    reactants: 4, // 1 + 3
                    products: 2   // 2
                },
                
                description: 'Industrial ammonia synthesis for fertilizers.',
                descriptionIs: 'I√∞na√∞arframlei√∞sla √° amm√≥n√≠aki fyrir √°bur√∞.'
            };
            
            return [exampleEquilibrium];
        };

        // ============================================
        // MAIN GAME COMPONENT
        // ============================================
        
        const EquilibriumShifter = () => {
            const [gameState, setGameState] = useState({
                screen: 'menu', // 'menu', 'playing', 'ice-table', 'results'
                mode: null, // 'learning' or 'challenge'
                difficulty: 'beginner',
                currentEquilibrium: null,
                appliedStress: null,
                userPrediction: null,
                correctShift: null,
                score: 0,
                streak: 0,
                questionNumber: 0,
                totalQuestions: 10,
                timeRemaining: 20,
                showExplanation: false,
                animationState: 'balanced', // 'balanced', 'shifting-left', 'shifting-right', 'no-shift'
            });

            const [equilibria] = useState(generateEquilibria());

            // Timer effect for Challenge mode
            useEffect(() => {
                if (gameState.mode === 'challenge' && 
                    gameState.screen === 'playing' && 
                    gameState.timeRemaining > 0 &&
                    gameState.appliedStress !== null &&
                    gameState.userPrediction === null) {
                    
                    const timer = setTimeout(() => {
                        setGameState(prev => ({
                            ...prev,
                            timeRemaining: prev.timeRemaining - 1
                        }));
                    }, 1000);

                    return () => clearTimeout(timer);
                }
            }, [gameState.timeRemaining, gameState.mode, gameState.screen, gameState.appliedStress, gameState.userPrediction]);

            // TODO: Implement game functions
            const startGame = (mode) => {
                console.log('Starting game in mode:', mode);
            };

            const applyStress = (stressType, stressTarget) => {
                console.log('Applying stress:', stressType, stressTarget);
            };

            const makePrediction = (prediction) => {
                console.log('User predicted:', prediction);
            };

            // ============================================
            // RENDER: Menu Screen
            // ============================================
            
            if (gameState.screen === 'menu') {
                return (
                    <div>
                        {/* Header */}
                        <header className="site-header">
                            <div className="header-content">
                                <a href="https://kvenno.app" className="site-logo">Kvenno.app</a>
                                <div>
                                    <button className="header-btn">
                                        Lei√∞beiningar
                                    </button>
                                </div>
                            </div>
                        </header>

                        {/* Back Button */}
                        <nav className="nav-container">
                            <a href="https://kvenno.app/games" className="back-btn">
                                ‚Üê {TRANSLATIONS.back}
                            </a>
                        </nav>

                        {/* Menu Content */}
                        <div className="max-w-4xl mx-auto px-4 py-8">
                            <div className="bg-white rounded-2xl shadow-xl p-8 text-center">
                                <h1 className="text-4xl md:text-5xl font-bold mb-4" 
                                    style={{color: 'var(--kvenno-orange)'}}>
                                    Equilibrium Shifter
                                </h1>
                                <h2 className="text-2xl text-gray-600 mb-8">
                                    Le Chatelier - Jafnv√¶gishli√∞run
                                </h2>

                                <div className="text-6xl mb-6">‚öñÔ∏èüß™‚áå</div>

                                <p className="text-lg text-gray-700 mb-8 max-w-2xl mx-auto">
                                    L√¶ra um Le Chatelier's principle me√∞ gagnvirkum jafnv√¶gisspilum. 
                                    Forsp√° hvernig jafnv√¶gi hli√∞rast √æegar √°lag er beitt!
                                </p>

                                <p className="text-base text-gray-600 mb-8">
                                    Learn Le Chatelier's principle with interactive equilibrium games. 
                                    Predict how equilibrium shifts when stress is applied!
                                </p>

                                {/* Mode Selection */}
                                <div className="grid md:grid-cols-2 gap-6 max-w-3xl mx-auto">
                                    <button
                                        onClick={() => startGame('learning')}
                                        className="bg-blue-500 hover:bg-blue-600 text-white font-bold py-6 px-8 rounded-xl text-xl transition-all transform hover:scale-105">
                                        üìö {TRANSLATIONS.learningMode}
                                        <div className="text-sm mt-2 opacity-90">
                                            √ìt√≠matakm√∂rku√∞ ‚Ä¢ √ötsk√Ωringar ‚Ä¢ √Üfa
                                        </div>
                                    </button>

                                    <button
                                        onClick={() => startGame('challenge')}
                                        className="bg-gradient-to-r from-orange-500 to-red-500 hover:from-orange-600 hover:to-red-600 text-white font-bold py-6 px-8 rounded-xl text-xl transition-all transform hover:scale-105">
                                        üèÜ {TRANSLATIONS.challengeMode}
                                        <div className="text-sm mt-2 opacity-90">
                                            T√≠ma√ær√Ωstingur ‚Ä¢ Stigat√∂flur ‚Ä¢ Keppni
                                        </div>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                );
            }

            // ============================================
            // RENDER: Playing Screen
            // ============================================
            
            if (gameState.screen === 'playing') {
                const eq = gameState.currentEquilibrium || equilibria[0];
                
                return (
                    <div>
                        {/* Header with Stats */}
                        <header className="site-header">
                            <div className="header-content">
                                <a href="https://kvenno.app" className="site-logo">Kvenno.app</a>
                                <div className="flex items-center gap-4 text-sm">
                                    {gameState.mode === 'challenge' && (
                                        <>
                                            <div><span className="font-bold">{TRANSLATIONS.score}:</span> {gameState.score}</div>
                                            <div><span className="font-bold">{TRANSLATIONS.streak}:</span> {gameState.streak} üî•</div>
                                            <div><span className="font-bold">{TRANSLATIONS.time}:</span> {gameState.timeRemaining}s</div>
                                        </>
                                    )}
                                </div>
                            </div>
                        </header>

                        {/* Main Game Area */}
                        <div className="max-w-6xl mx-auto px-4 py-8">
                            {/* Chemical Equation */}
                            <div className="bg-white rounded-2xl shadow-xl p-8 mb-6">
                                <div className="text-center mb-4">
                                    <h2 className="text-2xl font-bold text-gray-800 mb-2">
                                        {eq.nameIs} / {eq.name}
                                    </h2>
                                    <div className="text-3xl font-bold text-gray-900 mb-4">
                                        {eq.equation}
                                    </div>
                                    <div className={`thermo-indicator ${eq.deltaH < 0 ? 'exothermic' : 'endothermic'}`}>
                                        {eq.deltaH < 0 ? 'üî•' : '‚ùÑÔ∏è'} 
                                        ŒîH = {eq.deltaH > 0 ? '+' : ''}{eq.deltaH} kJ
                                        <span className="ml-2">
                                            ({eq.deltaH < 0 ? TRANSLATIONS.exothermic : TRANSLATIONS.endothermic})
                                        </span>
                                    </div>
                                </div>

                                {/* Visual Equilibrium Display */}
                                <div className="grid md:grid-cols-3 gap-4 items-center">
                                    {/* Reactants */}
                                    <div className={`molecule-container reactants-side ${gameState.animationState === 'shifting-left' ? 'glowing' : ''}`}>
                                        {eq.reactants.map((reactant, idx) => (
                                            <div key={idx} className="text-center">
                                                <div className="molecule">{reactant.display}</div>
                                                <div className="text-sm font-semibold">{reactant.formula}</div>
                                            </div>
                                        ))}
                                    </div>

                                    {/* Equilibrium Arrows */}
                                    <div className="text-center">
                                        <div className={`equilibrium-arrows ${gameState.animationState === 'shifting-right' ? 'shift-right' : gameState.animationState === 'shifting-left' ? 'shift-left' : gameState.animationState === 'no-shift' ? 'no-shift' : ''}`}>
                                            ‚áå
                                        </div>
                                    </div>

                                    {/* Products */}
                                    <div className={`molecule-container products-side ${gameState.animationState === 'shifting-right' ? 'glowing' : ''}`}>
                                        {eq.products.map((product, idx) => (
                                            <div key={idx} className="text-center">
                                                <div className="molecule">{product.display}</div>
                                                <div className="text-sm font-semibold">{product.formula}</div>
                                            </div>
                                        ))}
                                    </div>
                                </div>
                            </div>

                            {/* Stress Selection & Prediction */}
                            <div className="grid md:grid-cols-2 gap-6">
                                {/* Stress Buttons */}
                                <div className="bg-white rounded-2xl shadow-xl p-6">
                                    <h3 className="text-lg font-bold mb-4">{TRANSLATIONS.stress}:</h3>
                                    <div className="grid grid-cols-2 gap-3">
                                        <button className="stress-btn">
                                            ‚ûï {TRANSLATIONS.addReactant}
                                        </button>
                                        <button className="stress-btn">
                                            ‚ûï {TRANSLATIONS.addProduct}
                                        </button>
                                        <button className="stress-btn">
                                            üî• {TRANSLATIONS.heat}
                                        </button>
                                        <button className="stress-btn">
                                            ‚ùÑÔ∏è {TRANSLATIONS.cool}
                                        </button>
                                        <button className="stress-btn">
                                            ‚¨ÜÔ∏è {TRANSLATIONS.increasePressure}
                                        </button>
                                        <button className="stress-btn">
                                            ‚¨áÔ∏è {TRANSLATIONS.decreasePressure}
                                        </button>
                                    </div>
                                </div>

                                {/* Prediction Buttons */}
                                <div className="bg-white rounded-2xl shadow-xl p-6">
                                    <h3 className="text-lg font-bold mb-4">{TRANSLATIONS.predict}:</h3>
                                    <div className="flex flex-col gap-4">
                                        <button className="predict-btn left">
                                            ‚Üê {TRANSLATIONS.shiftLeft}
                                        </button>
                                        <button className="predict-btn none">
                                            ‚öñÔ∏è {TRANSLATIONS.noShift}
                                        </button>
                                        <button className="predict-btn right">
                                            {TRANSLATIONS.shiftRight} ‚Üí
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                );
            }

            // TODO: Add Results Screen
            return null;
        };

        // ============================================
        // RENDER APP
        // ============================================
        
        ReactDOM.render(<EquilibriumShifter />, document.getElementById('root'));
    </script>
</body>
</html>
